#include "stdio.h"
#include "../build_x86/include/openssl/aes.h"

#define AES_DECODE_KEY "1269571569321021"
char srcdata[] = {0x2d, 0xbd, 0xbf, 0x20, 0x71, 0x02, 0x79, 0x94, 0xcf, 0x30, 0xbf, 0xae, 0x45, 0xf5, 0x57, 0xaa, 0xe9, 0x8b, 0xdf, 0xa6, 0xee, 0xa8, 0x34, 0x77, 0xa9, 0xd0, 0xae, 0xaa, 0xf7, 0x72, 0x4b, 0xd6, 0x0d, 0x15, 0xfd, 0x3d, 0xc5, 0xd8, 0x9a, 0x2a, 0x74, 0x03, 0x77, 0xa4, 0xe8, 0xfa, 0x42, 0x32, 0x10, 0xef, 0x9b, 0x90, 0x8b, 0xf1, 0x1a, 0xf8, 0xb2, 0xad, 0x75, 0x39, 0x90, 0xc8, 0xe3, 0xe6, 0xa4, 0x38, 0x29, 0xab, 0x01, 0x71, 0xe2, 0x07, 0x1d, 0x47, 0x4b, 0xfe, 0x4b, 0xcb, 0x32, 0xcd};
char *data = "1234567890";
char *encode_data[128] = {0};
char outdata[160] = {0};

int main(int argc, char const *argv[])
{
    unsigned char tmpiv[17] = AES_DECODE_KEY;
    //memcpy(tmpiv, AES_DECODE_KEY, 16);
    // 测试aes解密,cbc
    AES_KEY decryptkey;
    AES_KEY encryptkey;
    // 设置密钥,字符串格式
    AES_set_decrypt_key((unsigned char*)AES_DECODE_KEY, 8*strlen(AES_DECODE_KEY), &decryptkey);
    AES_set_encrypt_key((unsigned char*)AES_DECODE_KEY, 8*strlen(AES_DECODE_KEY), &encryptkey);
#if 0
    AES_cbc_encrypt(data, encode_data, 128, &encryptkey, tmpiv, AES_ENCRYPT);
    //printf("ecode data %s\n", encode_data);
    // 修改iv,复位
    memcpy(tmpiv, AES_DECODE_KEY, 16);
#endif
    printf("srcdata size %d\n", sizeof(srcdata));
    AES_cbc_encrypt(srcdata, outdata, sizeof(srcdata), &decryptkey, tmpiv, AES_DECRYPT);

    printf("dec %s\n", outdata);
    return 0;
}
